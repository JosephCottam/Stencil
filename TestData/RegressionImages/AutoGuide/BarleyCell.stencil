STREAM: File
NAME: Barley
HEADER: year, site, yield, variety
SEPARATOR: \s*,\s+
SOURCE: /Volumes/OSL.image/home/jcottam/scratch/Stencil/Stencil/TestData/RegressionImages/AutoGuide/BeckersBarley.csv
SKIP: 1
STRICT: true

import BrewerPalettes

stream Barley(year, site, yield, variety)

canvas Main
  guide axis[axisLabel: "Variety", X:0] from BarleySite Y
  guide 
    axis[axisLabel: "Yield", 
         sample: "LINEAR", seed.min: 10, seed.max: 100]
    from BarleySite X
  guide 
    sidebar[X: 75, Y: -60] 
    from BarleySite PEN_COLOR
      example.FILL_COLOR: @Color{GRAY90}

layer BarleySite
  from Barley
    filter(site =~ "University Farm") 
    ID: Concatenate(variety,year)
    PEN_COLOR: BrewerColors[palette: "PuRd"](year)
    FILL_COLOR: @Color{CLEAR}
    X:* Scale[min: 0, max:100, inMin: 10, inMax: 100](yield)
    Y:* Rank(variety) -> Mult(-7,_) -> Add(-5,_)
    REGISTRATION: "CENTER"
