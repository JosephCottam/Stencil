STREAM: File
NAME: Values
HEADER: Category
SEPARATOR: ,
SOURCE: ./Fruits.txt
SKIP: 0
STRICT: true

stream Values(Category)

canvas Main
	guide axis[sample: "CATEGORICAL", tickSize: 5, textOffset: 6] from Chart X
  		label.FONT: @Font{10}
		line.PEN: @Stroke{1}
		label.REGISTRATION: "LEFT"

	guide legend[sample: "LINEAR", round: "TRUE", spacing: 1] from Chart FILL_COLOR
		label.FONT : @Font{10}
		example.SIZE: 9

layer Chart
from Values
  ID : Count() 				/*Give everything a unique ID.*/
  X :* Rank(Category) -> Add(rank, 1) -> Mult(sum, 11)
  Y : Count(Category) -> Mult(count, -11)
  SIZE: 10
  REGISTRATION: "CENTER"
  FILL_COLOR:* Count(Category) -#> HeatScale[cold: "RED", hot: "GRAY90"](count)
  /*The above line uses two special forms: Dynamic bind and "reframe" map.*/
  /*Dyanmic bind ":*" keeps results up to date in a globally changing context.*/
  /*Reframe map "-#>" is used by operator generation to indicate that the results
	  before the reframe should be used as labels, not the incomming values.*/
