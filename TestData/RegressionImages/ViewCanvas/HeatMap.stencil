STREAM: Mouse
NAME: Mouse
FREQUENCY: 30

import ViewCanvas

stream Mouse(X, Y, BUTTON, SCREEN_X, SCREEN_Y, DELTA_X, DELTA_Y, CLICK_COUNT, CTRL, ALT, SHIFT, META, TYPE)

canvas main[BACKGROUND_COLOR: "BLACK"]

view
from Mouse
    filter(BUTTON=1) 
    filter(TYPE=~"DRAG")
    filter(SHIFT!~"TRUE")
    X : ScreenToCanvasDimension(DELTA_X,0) -> Sub(view.X, ScreenToCanvasDimension.Width)
    Y : ScreenToCanvasDimension(0,DELTA_Y) -> Sub(view.Y, ScreenToCanvasDimension.Height)
from Mouse
    filter(BUTTON=1)
    filter(SHIFT=~"true")
    filter(TYPE=~"DRAG") 
    ZOOM : Mult(DELTA_Y, .01) -> Add(Mult, view.ZOOM)
from Mouse
    filter(BUTTON=1)
    filter(CLICK_COUNT=3)
    (WIDTH, HEIGHT, X,Y) : (canvas.WIDTH, canvas.HEIGHT, canvas.X, canvas.Y)



layer Heat
from Mouse
    ID : Count()
    (X,Y) : (X,Y)
    FILL_COLOR: Colorize(META)
    SIZE: 10
    PEN_COLOR : @Color{CLEAR}


operator Colorize(Meta) -> C
    (Meta !~ "true") => C: @Color{WHITE}
    (Meta =~ "true") => C: @Color{GREEN}
