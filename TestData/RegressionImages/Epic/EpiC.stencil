import ViewCanvas

stream Data(Timestep, Line, Value) from Text["./EpicSampleData.csv"]
stream Visibility(Line, Visible) from Text["./Visibliity.txt"]
stream LineColor(Line, Color) from Text[" ./LineColor.txt"]

order (Data | Visibility | LineColor)

view
from #Render
	local(WidthOffset, HeightOffset) : ScreenToCanvasDimension(60, 20)
	W : Mult(canvas.W, 1.2)
	H : Mult(canvas.H, 1.2)
	X : Sub(canvas.X, local.WidthOffset)
	Y : Mult(canvas.H, -1) -> Sub(_, local.HeightOffset)

layer Lines["POLY_POINT"]
guide
	axis[tickCount: 10,  tickSize: 5, textOffset: 6, axisOffset: 10] Linear from X
       label.IMPLANT: "POINT"
       label.FONT: Font{10}
       label.REGISTRATION: "LEFT"
       line.PEN: Stroke{1}
	axis[tickCount: 10, tickSize: 5, textOffset: 6, axisOffset: 10] Linear from Y
       label.IMPLANT: "POINT"
       label.FONT: Font{10}
	    label.REGISTRATION: "RIGHT"
       line.PEN: Stroke{1}

from Data
	ID : Count(Line) -> Concatenate(Line, _)
	GROUP: Line
	ORDER: Count()
	X : Index(Timestep) -#> Mult(_, 300)
	Y: Value 
   IMPLANT: "POINT"
	PEN: Stroke{1.5}
from Visibility
	ID : Concatenate(Line,1)
	VISIBLE : Visible
from LineColor
	ID : Concatenate(Line,1)
	PEN_COLOR: Color


operator Stride (T) -> (VALUE)
	default => (VALUE) :  Index(T) -> Mult(Index, 3)
