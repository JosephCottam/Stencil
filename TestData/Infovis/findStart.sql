SELECT distinct ts.id, ts.start_id, ts.start_time, ts.end_id, ts.end_time,  if(coalesce(mj.id_from,0) = 0, 1, 0) as terminal   FROM    (SELECT distinct mt.id, mt.start_id, mt.start_time, mt.end_id, mt.end_time        FROM motionsensors_tracklets2 mt         LEFT JOIN motionsensors_tracklets2_joints mtj 	  ON mt.id=mtj.id_to 	  WHERE	  mtj.id_from is NULL 	  AND mt.start_id = 277	  ORDER BY id asc)   ts LEFT JOIN motionsensors_tracklets2_joints mj ON mj.id_from = ts.id